cordova.define("org.apache.cordova.core.geolocation.geolocation",function(e,t,n){function f(e){var t={maximumAge:0,enableHighAccuracy:!1,timeout:Infinity};if(e){e.maximumAge!==undefined&&!isNaN(e.maximumAge)&&e.maximumAge>0&&(t.maximumAge=e.maximumAge);e.enableHighAccuracy!==undefined&&(t.enableHighAccuracy=e.enableHighAccuracy);e.timeout!==undefined&&!isNaN(e.timeout)&&(e.timeout<0?t.timeout=0:t.timeout=e.timeout)}return t}function l(e,t){var n=setTimeout(function(){clearTimeout(n);n=null;e({code:o.TIMEOUT,message:"Position retrieval timed out."})},t);return n}var r=e("cordova/argscheck"),i=e("cordova/utils"),s=e("cordova/exec"),o=e("./PositionError"),u=e("./Position"),a={},c={lastPosition:null,getCurrentPosition:function(e,t,n){r.checkArgs("fFO","geolocation.getCurrentPosition",arguments);n=f(n);var i={timer:null},a=function(t){clearTimeout(i.timer);if(!i.timer)return;var n=new u({latitude:t.latitude,longitude:t.longitude,altitude:t.altitude,accuracy:t.accuracy,heading:t.heading,velocity:t.velocity,altitudeAccuracy:t.altitudeAccuracy},t.timestamp===undefined?new Date:t.timestamp instanceof Date?t.timestamp:new Date(t.timestamp));c.lastPosition=n;e(n)},h=function(e){clearTimeout(i.timer);i.timer=null;var n=new o(e.code,e.message);t&&t(n)};if(c.lastPosition&&n.maximumAge&&(new Date).getTime()-c.lastPosition.timestamp.getTime()<=n.maximumAge)e(c.lastPosition);else if(n.timeout===0)h({code:o.TIMEOUT,message:"timeout value in PositionOptions set to 0 and no cached Position object available, or cached Position object's age exceeds provided PositionOptions' maximumAge parameter."});else{n.timeout!==Infinity?i.timer=l(h,n.timeout):i.timer=!0;s(a,h,"Geolocation","getLocation",[n.enableHighAccuracy,n.maximumAge])}return i},watchPosition:function(e,t,n){r.checkArgs("fFO","geolocation.getCurrentPosition",arguments);n=f(n);var h=i.createUUID();a[h]=c.getCurrentPosition(e,t,n);var p=function(e){clearTimeout(a[h].timer);var n=new o(e.code,e.message);t&&t(n)},d=function(t){clearTimeout(a[h].timer);n.timeout!==Infinity&&(a[h].timer=l(p,n.timeout));var r=new u({latitude:t.latitude,longitude:t.longitude,altitude:t.altitude,accuracy:t.accuracy,heading:t.heading,velocity:t.velocity,altitudeAccuracy:t.altitudeAccuracy},t.timestamp===undefined?new Date:t.timestamp instanceof Date?t.timestamp:new Date(t.timestamp));c.lastPosition=r;e(r)};s(d,p,"Geolocation","addWatch",[h,n.enableHighAccuracy]);return h},clearWatch:function(e){if(e&&a[e]!==undefined){clearTimeout(a[e].timer);a[e].timer=!1;s(null,null,"Geolocation","clearWatch",[e])}}};n.exports=c});